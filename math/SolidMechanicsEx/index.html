<!doctype html>
<html class="no-js" lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Solid mechanics: Simulation Setup</title>
	<link rel="stylesheet" type="text/css" href="http://redbkit.github.io/redbKIT/assets/css/styles_feeling_responsive.css">
	<script src="http://redbkit.github.io/redbKIT/assets/js/modernizr.min.js"></script>

	<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
	<script>
		WebFont.load({
			google: {
				families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ]
			}
		});
	</script>

	<noscript>
		<link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic%7CVolkhov' rel='stylesheet' type='text/css'>
	</noscript>


	<!-- Search Engine Optimization -->
	<meta name="description" content="We provide here an example of data and main files which are used to setup a simulation.">
  	
	
	
	
	


	<!-- Facebook Open Graph -->
	<meta property="og:title" content="Solid mechanics: Simulation Setup">
	<meta property="og:description" content="We provide here an example of data and main files which are used to setup a simulation.">
	<meta property="og:url" content="http://redbkit.github.io/redbKIT/math/SolidMechanicsEx/">
	<meta property="og:locale" content="en_EN">
	<meta property="og:type" content="website">
	<meta property="og:site_name" content="redbKIT">
	
	


	

	<link type="text/plain" rel="author" href="http://redbkit.github.io/redbKIT/humans.txt">

	

	

	<link rel="icon" sizes="32x32" href="http://redbkit.github.io/redbKIT/assets/img/favicon-32x32.png">

	<link rel="icon" sizes="192x192" href="http://redbkit.github.io/redbKIT/assets/img/touch-icon-192x192.png">

	<link rel="apple-touch-icon-precomposed" sizes="180x180" href="http://redbkit.github.io/redbKIT/assets/img/apple-touch-icon-180x180-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="152x152" href="http://redbkit.github.io/redbKIT/assets/img/apple-touch-icon-152x152-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://redbkit.github.io/redbKIT/assets/img/apple-touch-icon-144x144-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="120x120" href="http://redbkit.github.io/redbKIT/assets/img/apple-touch-icon-120x120-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://redbkit.github.io/redbKIT/assets/img/apple-touch-icon-114x114-precomposed.png">

	
	<link rel="apple-touch-icon-precomposed" sizes="76x76" href="http://redbkit.github.io/redbKIT/assets/img/apple-touch-icon-76x76-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://redbkit.github.io/redbKIT/assets/img/apple-touch-icon-72x72-precomposed.png">

	<link rel="apple-touch-icon-precomposed" href="http://redbkit.github.io/redbKIT/assets/img/apple-touch-icon-precomposed.png">	

	<meta name="msapplication-TileImage" content="http://redbkit.github.io/redbKIT/assets/img/msapplication_tileimage.png">

	<meta name="msapplication-TileColor" content="#fabb00">


	

	
        <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    tex2jax: {
      inlineMath: [ ['$','$'] ],
      displayMath: [ ['$$','$$'] ],
      processEscapes: true,
    }
  });
</script>
<script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ TeX: { extensions: ["color.js"] }});
</script>

        
</head>
<body id="top-of-page" class="page-fullwidth">
	
	<div id="navigation" class="sticky">
  <nav class="top-bar" role="navigation" data-topbar>
    <ul class="title-area">
      <li class="name">
      <h1 class="show-for-small-only"><a href="http://redbkit.github.io/redbKIT" class="icon-tree"> redbKIT</a></h1>
    </li>
       <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
      <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li>
    </ul>
    <section class="top-bar-section">

      <ul class="right">
        

              

          
          
        

              

          
          
        

              

          
          
        

              

          
          
        

              

          
          
        

              

          
          
        

              

          
          
            
            
              <li class="divider"></li>
              <li><a href="http://redbkit.github.io/redbKIT/search/">Search</a></li>

            
            
          
        

              

          
          
            
            
              <li class="divider"></li>
              <li><a href="http://redbkit.github.io/redbKIT/contact/">Contact</a></li>

            
            
          
        
        
      </ul>

      <ul class="left">
        

              

          
          

            
            
              <li><a href="http://redbkit.github.io/redbKIT/">About</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            
              <li><a href="http://redbkit.github.io/redbKIT/download-install/">Download and Install</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            
              <li><a href="http://redbkit.github.io/redbKIT/getting-started/">Getting Started</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            
              <li><a href="http://redbkit.github.io/redbKIT/probgallery/">Problems Gallery</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            
              <li><a href="http://redbkit.github.io/redbKIT/contributors/">Development</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            

              <li class="has-dropdown">
                <a href="http://redbkit.github.io/redbKIT/documentation/">Documentation</a>

                  <ul class="dropdown">
                    

                      


			
                      
		      
			<li class="has-dropdown">
                <a href="http://redbkit.github.io/redbKIT/math/ADR/">Advection diffusion reaction</a>

                  <ul class="dropdown">
                    

                      

                      <li><a href="http://redbkit.github.io/redbKIT/math/AdvDiffReact/">Advection diffusion reaction equations</a></li>
			

                      

                      <li><a href="http://redbkit.github.io/redbKIT/math/AdvDiffReactEx/">Simulation Setup</a></li>
			
</ul>
 </li>
		                          
		      
			

                      


			
                      
		      
			<li class="has-dropdown">
                <a href="http://redbkit.github.io/redbKIT/math/CFD/">Computational Fluid Dynamics</a>

                  <ul class="dropdown">
                    

                      

                      <li><a href="http://redbkit.github.io/redbKIT/math/NavierStokes/">Navier-Stokes equations</a></li>
			

                      

                      <li><a href="http://redbkit.github.io/redbKIT/math/NavierStokesEx/">Simulation Setup</a></li>
			
</ul>
 </li>
		                          
		      
			

                      


			
                      
		      
			<li class="has-dropdown">
                <a href="http://redbkit.github.io/redbKIT/math/CSM/">Computational Solid Mechanics</a>

                  <ul class="dropdown">
                    

                      

                      <li><a href="http://redbkit.github.io/redbKIT/math/SolidMechanics/">Hyperelasticity: static and dynamics</a></li>
			

                      

                      <li><a href="http://redbkit.github.io/redbKIT/math/SolidMechanicsEx/">Simulation Setup</a></li>
			
</ul>
 </li>
		                          
		      
			

                      


			
                      
		      
			<li class="has-dropdown">
                <a href="http://redbkit.github.io/redbKIT/math/FSI/">Fluid-Structure Interaction</a>

                  <ul class="dropdown">
                    

                      

                      <li><a href="http://redbkit.github.io/redbKIT/math/FSIsolver/">Monolithic FSI solver</a></li>
			

                      

                      <li><a href="http://redbkit.github.io/redbKIT/math/FSIEx/">Simulation Setup</a></li>
			

                      

                      <li><a href="http://redbkit.github.io/redbKIT/math/FSIprestress/">Tissue prestress</a></li>
			
</ul>
 </li>
		                          
		      
			

                      


			
                      
		      
                      <li><a href="http://redbkit.github.io/redbKIT/math/essentialbc/">Essential Boundary Conditions</a></li>
		                          
		      
			
                  </ul>

              </li>
              <li class="divider"></li>
            
          
        

              

          
          
        

              

          
          
        
        
      </ul>
    </section>
  </nav>
</div><!-- /#navigation -->

	

	



<div id="masthead-with-text">
	<div class="row">
		<div class="medium-9 small-centered columns">
			<a id="forkme_banner" href="https://github.com/redbKIT/redbKIT">View on GitHub</a>
			<section id="downloads">
             			 <a class="zip_download_link" href="https://github.com/redbKIT/redbKIT/archive/v2.2.zip">Download this project as a .zip file</a>
             			 <a class="tar_download_link" href="https://github.com/redbKIT/redbKIT/archive/v2.2.tar.gz">Download this project as a tar.gz file</a>
			</section>
			<div class="masthead-title"><b>redbKIT</b> <br/> <small>a MATLAB library for reduced-order modeling of PDEs</small></div>
		</div> 
	</div> 
</div> 







	


<div class="row t30">
	<div class="medium-9 small-centered columns">
		<article>
			<header>
				
				<h1>Solid mechanics: Simulation Setup</h1>
			</header>

			
			<p class="teaser">
				We provide here an example of data and main files which are used to setup a simulation.
			</p>
			

			<script type="math/tex; mode=display">\newcommand{\bm}[1]{\boldsymbol{\mathbf{#1}}}
\newcommand{\bvec}[1]{\mathbf{#1}}
\newcommand{\bx}{\mathbf{x}}
\newcommand{\bd}{\mathbf{d}}
\newcommand{\bv}{\dot{\mathbf{d}}}
\newcommand{\ba}{\ddot{\mathbf{d}}}
\newcommand{\bmw}{\mathbf{w}}
\newcommand{\bmv}{\mathbf{v}}
\newcommand{\Nh}[1][]{N_{h,#1}}
\newcommand{\bU}{\mathbf{U}}
\newcommand{\bp}{\bvec{p}}
\newcommand{\VV}{\mathbf{V}}
\newcommand{\WW}{\mathbf{W}}
\newcommand{\QQ}{\mathbf{Q}}
\renewcommand{\AA}{\mathbf{A}}
\newcommand{\BB}{\mathbf{B}}
\newcommand{\CC}{\mathbf{B}}
\newcommand{\EE}{\mathbf{E}}
\newcommand{\FF}{\mathbf{F}}
\newcommand{\FFi}{\mathbf{f}^i}
\newcommand{\FFe}{\mathbf{f}^e}
\newcommand{\GG}{\mathbf{G}}
\newcommand{\CC}{\mathbf{C}}
\newcommand{\MM}{\mathbf{M}}
\newcommand{\XX}{\mathbf{X}}
\newcommand{\KK}{\mathbf{K}}
\newcommand{\UU}{\mathbf{U}}
\newcommand{\II}{\mathbf{I}}
\renewcommand{\SS}{\mathbf{S}}
\newcommand{\HH}{\mathbf{H}}
\newcommand{\DD}{\mathbf{D}}
\newcommand{\NN}{\mathbf{N}}
\newcommand{\bmg}{\mathbf{g}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\JJ}{\mathbf{J}}
\newcommand{\RR}{\mathbf{R}}
\newcommand{\PP}{\mathbf{P}}</script>

<h2 id="datafile-options">Datafile options</h2>

<p>Define the 3 components of the volumetric forces (i.e. the right-hand side term <script type="math/tex">\mathbf{f}</script>)</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="c1">% Source term</span>
<span class="n">data</span><span class="o">.</span><span class="n">force</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">param</span><span class="p">)(</span><span class="mf">0.</span><span class="o">*</span><span class="n">x</span><span class="o">.*</span><span class="n">y</span><span class="o">.*</span><span class="n">z</span><span class="p">);</span>
<span class="n">data</span><span class="o">.</span><span class="n">force</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">param</span><span class="p">)(</span><span class="mf">0.</span><span class="o">*</span><span class="n">x</span><span class="o">.*</span><span class="n">y</span><span class="o">.*</span><span class="n">z</span><span class="p">);</span>
<span class="n">data</span><span class="o">.</span><span class="n">force</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">param</span><span class="p">)(</span><span class="mf">0.</span><span class="o">*</span><span class="n">x</span><span class="o">.*</span><span class="n">y</span><span class="o">.*</span><span class="n">z</span><span class="p">);</span>
</code></pre>
</div>

<p>Set the flags for the boundary conditions: on boundaries [2 3 4 5 6] we impose Dirichlet (essential) conditions on all the 3 components of the displacement. On boundary 200 we impose a normal pressure, i.e.</p>

<script type="math/tex; mode=display">\PP(\bd) \mathbf{n} = p \mathbf{n}.</script>

<p>On boundary 210 we impose a Robin condition plus an external normal pressure, i.e.</p>

<script type="math/tex; mode=display">\PP(\bd) \mathbf{n} + \alpha \bd = p \mathbf{n}.</script>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">data</span><span class="o">.</span><span class="n">flag_dirichlet</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">];</span>
<span class="n">data</span><span class="o">.</span><span class="n">flag_neumann</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span>   <span class="o">=</span> <span class="p">[];</span>
<span class="n">data</span><span class="o">.</span><span class="n">flag_pressure</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">200</span> <span class="mi">210</span><span class="p">];</span>
<span class="n">data</span><span class="o">.</span><span class="n">flag_robin</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span>     <span class="o">=</span> <span class="p">[</span><span class="mi">210</span><span class="p">];</span>

<span class="n">data</span><span class="o">.</span><span class="n">flag_dirichlet</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">];</span>
<span class="n">data</span><span class="o">.</span><span class="n">flag_neumann</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span>   <span class="o">=</span> <span class="p">[];</span>
<span class="n">data</span><span class="o">.</span><span class="n">flag_pressure</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">200</span> <span class="mi">210</span><span class="p">];</span>
<span class="n">data</span><span class="o">.</span><span class="n">flag_robin</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span>     <span class="o">=</span> <span class="p">[</span><span class="mi">210</span><span class="p">];</span>

<span class="n">data</span><span class="o">.</span><span class="n">flag_dirichlet</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">];</span>
<span class="n">data</span><span class="o">.</span><span class="n">flag_neumann</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span>   <span class="o">=</span> <span class="p">[];</span>
<span class="n">data</span><span class="o">.</span><span class="n">flag_pressure</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">200</span> <span class="mi">210</span><span class="p">];</span>
<span class="n">data</span><span class="o">.</span><span class="n">flag_robin</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span>     <span class="o">=</span> <span class="p">[</span><span class="mi">210</span><span class="p">];</span>
</code></pre>
</div>

<p>Specify the functions for Dirichlet, Neumann, Robin, and normal pressure boundary conditions</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="c1">% Dirichlet</span>
<span class="n">data</span><span class="o">.</span><span class="n">bcDir</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">param</span><span class="p">)(</span><span class="mf">0.</span><span class="o">*</span><span class="n">x</span><span class="o">.*</span><span class="n">y</span><span class="o">.*</span><span class="n">z</span><span class="p">);</span>
<span class="n">data</span><span class="o">.</span><span class="n">bcDir</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">param</span><span class="p">)(</span><span class="mf">0.</span><span class="o">*</span><span class="n">x</span><span class="o">.*</span><span class="n">y</span><span class="o">.*</span><span class="n">z</span><span class="p">);</span>
<span class="n">data</span><span class="o">.</span><span class="n">bcDir</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">param</span><span class="p">)(</span><span class="mf">0.</span><span class="o">*</span><span class="n">x</span><span class="o">.*</span><span class="n">y</span><span class="o">.*</span><span class="n">z</span><span class="p">);</span>

<span class="c1">% Neumann</span>
<span class="n">data</span><span class="o">.</span><span class="n">bcNeu</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">param</span><span class="p">)(</span><span class="mf">0.</span><span class="o">*</span><span class="n">x</span><span class="o">.*</span><span class="n">y</span><span class="o">.*</span><span class="n">z</span><span class="p">);</span>
<span class="n">data</span><span class="o">.</span><span class="n">bcNeu</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">param</span><span class="p">)(</span><span class="mf">0.</span><span class="o">*</span><span class="n">x</span><span class="o">.*</span><span class="n">y</span><span class="o">.*</span><span class="n">z</span><span class="p">);</span>
<span class="n">data</span><span class="o">.</span><span class="n">bcNeu</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">param</span><span class="p">)(</span><span class="mi">0</span> <span class="o">+</span> <span class="mf">0.</span><span class="o">*</span><span class="n">x</span><span class="o">.*</span><span class="n">y</span><span class="o">.*</span><span class="n">z</span><span class="p">);</span>

<span class="c1">% Normal Pressure</span>
<span class="n">data</span><span class="o">.</span><span class="n">bcPrex</span><span class="p">{</span><span class="mi">200</span><span class="p">}</span>   <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">param</span><span class="p">)(</span><span class="o">-</span><span class="mi">80</span><span class="o">*</span><span class="mi">1333</span> <span class="o">+</span> <span class="mi">0</span><span class="o">*</span><span class="n">x</span><span class="o">.*</span><span class="n">y</span><span class="o">.*</span><span class="n">z</span><span class="p">);</span><span class="c1">%dyn/cm^2</span>
<span class="n">data</span><span class="o">.</span><span class="n">bcPrex</span><span class="p">{</span><span class="mi">210</span><span class="p">}</span>   <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">param</span><span class="p">)(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="mi">1333</span> <span class="o">+</span> <span class="mi">0</span><span class="o">*</span><span class="n">x</span><span class="o">.*</span><span class="n">y</span><span class="o">.*</span><span class="n">z</span><span class="p">);</span><span class="c1">%dyn/cm^2</span>

<span class="n">data</span><span class="o">.</span><span class="n">ElasticCoefRobin</span> <span class="o">=</span> <span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">;</span>
</code></pre>
</div>

<p>Set material model and corresponding parameters. In particular for Linear, StVenantKirchhoff and NeoHookean material models, Young modulus and Poisson ratio should be provided. For the RaghavanVorp material model, the Alpha, Beta and Bulk parameters should be provided instead. Density is needed only for time-dependent simulations.</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="c1">% material parameters</span>
<span class="n">data</span><span class="o">.</span><span class="n">Material_Model</span> <span class="o">=</span> <span class="s1">'StVenantKirchhoff'</span><span class="p">;</span><span class="c1">% 'Linear','NeoHookean','RaghavanVorp'</span>
<span class="n">data</span><span class="o">.</span><span class="n">Young</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">^</span><span class="mi">7</span><span class="p">;</span><span class="c1">%dyn/cm^2</span>
<span class="n">data</span><span class="o">.</span><span class="n">Poisson</span> <span class="o">=</span> <span class="mf">0.45</span><span class="p">;</span>
<span class="c1">%data.Alpha  = ... ;</span>
<span class="c1">%data.Beta   = ... ;</span>
<span class="c1">%data.Bulk   = ... ;</span>

<span class="n">data</span><span class="o">.</span><span class="n">Density</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</code></pre>
</div>

<p>Set tolerance and maximum number of iterations of the nonlinear solver (Newton)</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="c1">% NonLinear Solver</span>
<span class="n">data</span><span class="o">.</span><span class="n">NonLinearSolver</span><span class="o">.</span><span class="n">tol</span>               <span class="o">=</span> <span class="mf">1e-6</span><span class="p">;</span>
<span class="n">data</span><span class="o">.</span><span class="n">NonLinearSolver</span><span class="o">.</span><span class="n">maxit</span>             <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="n">data</span><span class="o">.</span><span class="n">NonLinearSolver</span><span class="o">.</span><span class="n">backtrackIter</span>     <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
<span class="n">data</span><span class="o">.</span><span class="n">NonLinearSolver</span><span class="o">.</span><span class="n">backtrackFactor</span>   <span class="o">=</span> <span class="mf">0.7</span><span class="p">;</span>
</code></pre>
</div>

<p>Set parameters for the linear solver and preconditioner. In this case, if a parallel pool is open we use gmres with a one-level Additive Schwarz preconditioner; otherwise we use a direct solver</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="c1">% Solver and Preconditioner</span>
<span class="c1">%   If parallel pool available, use gmres with AdditiveSchwarz preconditioner</span>
<span class="c1">%   Otherwise use direct solver</span>
<span class="n">poolobj</span> <span class="o">=</span> <span class="n">gcp</span><span class="p">(</span><span class="s1">'nocreate'</span><span class="p">);</span>
<span class="k">if</span> <span class="nb">isempty</span><span class="p">(</span><span class="n">poolobj</span><span class="p">)</span>
    <span class="n">poolsize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">else</span>
    <span class="n">poolsize</span> <span class="o">=</span> <span class="n">poolobj</span><span class="o">.</span><span class="n">NumWorkers</span><span class="p">;</span>
<span class="k">end</span>

<span class="k">if</span> <span class="n">poolsize</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="c1">% Linear Solver</span>
    <span class="n">data</span><span class="o">.</span><span class="n">LinearSolver</span><span class="o">.</span><span class="nb">type</span>              <span class="o">=</span> <span class="s1">'gmres'</span><span class="p">;</span> <span class="c1">% MUMPS, backslash, gmres</span>
    <span class="n">data</span><span class="o">.</span><span class="n">LinearSolver</span><span class="o">.</span><span class="n">tol</span>               <span class="o">=</span> <span class="mf">1e-7</span><span class="p">;</span>
    <span class="n">data</span><span class="o">.</span><span class="n">LinearSolver</span><span class="o">.</span><span class="n">maxit</span>             <span class="o">=</span> <span class="mi">800</span><span class="p">;</span>
    <span class="n">data</span><span class="o">.</span><span class="n">LinearSolver</span><span class="o">.</span><span class="n">gmres_verbosity</span>   <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="n">data</span><span class="o">.</span><span class="n">LinearSolver</span><span class="o">.</span><span class="n">mumps_reordering</span>  <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
    
    <span class="c1">% Preconditioner</span>
    <span class="n">data</span><span class="o">.</span><span class="n">Preconditioner</span><span class="o">.</span><span class="nb">type</span>         <span class="o">=</span> <span class="s1">'AdditiveSchwarz'</span><span class="p">;</span> <span class="c1">% AdditiveSchwarz, None, ILU</span>
    <span class="n">data</span><span class="o">.</span><span class="n">Preconditioner</span><span class="o">.</span><span class="n">local_solver</span> <span class="o">=</span> <span class="s1">'MUMPS'</span><span class="p">;</span> <span class="c1">% matlab_lu, MUMPS</span>
    <span class="n">data</span><span class="o">.</span><span class="n">Preconditioner</span><span class="o">.</span><span class="n">overlap_level</span>     <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
    <span class="n">data</span><span class="o">.</span><span class="n">Preconditioner</span><span class="o">.</span><span class="n">mumps_reordering</span>  <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
    <span class="n">data</span><span class="o">.</span><span class="n">Preconditioner</span><span class="o">.</span><span class="n">num_subdomains</span>    <span class="o">=</span> <span class="n">poolsize</span><span class="p">;</span> <span class="c1">%poolsize, number of subdomains</span>
    
<span class="k">else</span>
    
    <span class="c1">% Linear Solver</span>
    <span class="n">data</span><span class="o">.</span><span class="n">LinearSolver</span><span class="o">.</span><span class="nb">type</span>           <span class="o">=</span> <span class="s1">'MUMPS'</span><span class="p">;</span> <span class="c1">% MUMPS, backslash, gmres</span>
    <span class="c1">% Preconditioner</span>
    <span class="n">data</span><span class="o">.</span><span class="n">Preconditioner</span><span class="o">.</span><span class="nb">type</span>         <span class="o">=</span> <span class="s1">'None'</span><span class="p">;</span> <span class="c1">% AdditiveSchwarz, None, ILU</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Set time parameters for the generalized-$\alpha$ method</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="c1">% Time options</span>
<span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">t0</span>         <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span>         <span class="o">=</span> <span class="mf">0.005</span><span class="p">;</span> 
<span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">tf</span>         <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="nb">gamma</span>      <span class="o">=</span> <span class="mi">1</span><span class="p">/</span><span class="mi">2</span><span class="p">;</span>
<span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="nb">beta</span>       <span class="o">=</span> <span class="mi">1</span><span class="p">/</span><span class="mi">4</span><span class="p">;</span>
<span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">alpha_m</span>    <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">alpha_f</span>    <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</code></pre>
</div>

<p>Set output options. In this case we require to compute and export the Von Mises stress of the final solution</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="c1">% OutPut Options</span>
<span class="n">data</span><span class="o">.</span><span class="n">Output</span><span class="o">.</span><span class="n">ComputeVonMisesStress</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</code></pre>
</div>

<p>The Von Mises stress is defined as (in 3D)</p>

<script type="math/tex; mode=display">\sigma_{VM} = \sqrt{ \frac{1}{2} \left( (\sigma_{11} - \sigma_{22})^2 + (\sigma_{22} - \sigma_{33})^2 + (\sigma_{11} - \sigma_{33})^2 + 6 (\sigma_{23}^2 + \sigma_{31}^2 + \sigma_{12}^2)\right) }</script>

<p>where $\bm{\sigma} = J^{-1} \PP \FF^T$ is the Cauchy stress tensor.</p>

		</article>
	</div><!-- /.medium-12.columns -->
</div><!-- /.row -->




	
	    <div id="up-to-top" class="row">
      <div class="small-12 columns" style="text-align: right;">
        <a class="iconfont" href="#top-of-page">&#xf108;</a>
      </div><!-- /.small-12.columns -->
    </div><!-- /.row -->

      <div id="subfooter">
        <nav class="row">
          <section id="subfooter-left" class="small-12 medium-6 columns credits">
            <p><a href="https://www.linkedin.com/in/negrifederico/">&copy;Federico Negri</a>. Created with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> based on <a href="http://phlow.github.io/feeling-responsive/">Feeling Responsive</a>.</p>
          </section>

          <section id="subfooter-right" class="small-12 medium-6 columns">
            <ul class="inline-list social-icons">
            
            </ul>
          </section>
        </nav>
      </div><!-- /#subfooter -->
    </footer>

	

	


<script src="http://redbkit.github.io/redbKIT/assets/js/javascript.min.js"></script>







<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-64466050-1', 'auto');
  ga('set', 'anonymizeIp', true);
  ga('send', 'pageview');

</script>








</body>
<!--
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
-->
</html>

